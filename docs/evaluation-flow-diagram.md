# Evaluation Flow Diagram: Detailed Breakdown

æœ¬æ–‡ä»¶æä¾› Clef Study 1 è©•ä¼°æµç¨‹çš„è©³ç´°è¦–è¦ºåŒ–èªªæ˜ã€‚

---

## å®Œæ•´è©•ä¼°æµç¨‹åœ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          INPUT: Audio Recordings                            â”‚
â”‚                     (ASAP test set: 25 pieces / 80 recordings)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ (åˆ†ç™¼åˆ°ä¸åŒç³»çµ±)
                             â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â–¼                    â–¼                    â–¼                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     MT3       â”‚   â”‚   Transkun     â”‚   â”‚   Zeng (2024)  â”‚   â”‚  Clef (Ours)   â”‚
â”‚  + music21    â”‚   â”‚   + Beyer      â”‚   â”‚                â”‚   â”‚                â”‚
â”‚               â”‚   â”‚                â”‚   â”‚                â”‚   â”‚                â”‚
â”‚  Weak         â”‚   â”‚  Strong        â”‚   â”‚  E2E           â”‚   â”‚  E2E           â”‚
â”‚  Pipeline     â”‚   â”‚  Pipeline      â”‚   â”‚  Baseline      â”‚   â”‚  Proposed      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                    â”‚                     â”‚                    â”‚
        â”‚                    â”‚                     â”‚                    â”‚
â”Œâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”
â•‘                     STAGE 1: Model Inference                                  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        â”‚                    â”‚                     â”‚                    â”‚
        â–¼                    â–¼                     â–¼                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MIDI Output  â”‚   â”‚  MIDI Output   â”‚   â”‚ **Kern Output  â”‚   â”‚ **Kern Output  â”‚
â”‚               â”‚   â”‚                â”‚   â”‚                â”‚   â”‚                â”‚
â”‚ Single-track  â”‚   â”‚ Single-track   â”‚   â”‚ Upper + Lower  â”‚   â”‚ Upper + Lower  â”‚
â”‚ Performance   â”‚   â”‚ Performance    â”‚   â”‚ Symbolic       â”‚   â”‚ Symbolic       â”‚
â”‚ (continuous   â”‚   â”‚ (continuous    â”‚   â”‚ (discrete      â”‚   â”‚ (discrete      â”‚
â”‚  time)        â”‚   â”‚  time)         â”‚   â”‚  time)         â”‚   â”‚  time)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                    â”‚                     â”‚                    â”‚
        â”‚                    â”‚                     â”‚                    â”‚
â”Œâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”
â•‘                  STAGE 2: Symbolization / Conversion                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        â”‚                    â”‚                     â”‚                    â”‚
        â–¼                    â–¼                     â–¼                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  music21      â”‚   â”‚  Beyer Model   â”‚   â”‚  Humdrum       â”‚   â”‚  Humdrum       â”‚
â”‚  Pipeline     â”‚   â”‚  (Transformer) â”‚   â”‚  Toolkit       â”‚   â”‚  Toolkit       â”‚
â”‚               â”‚   â”‚                â”‚   â”‚                â”‚   â”‚                â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Parse MIDIâ”‚ â”‚   â”‚ â”‚Load Model  â”‚ â”‚   â”‚ â”‚  tiefix    â”‚ â”‚   â”‚ â”‚  tiefix    â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â”‚   â”‚ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚ â”‚ (fix ties) â”‚ â”‚   â”‚ â”‚ (fix ties) â”‚ â”‚
â”‚       â–¼       â”‚   â”‚       â–¼        â”‚   â”‚ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚       â–¼        â”‚   â”‚       â–¼        â”‚
â”‚ â”‚ Quantize  â”‚ â”‚   â”‚ â”‚Perfâ†’Score  â”‚ â”‚   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ (4,3)     â”‚ â”‚   â”‚ â”‚Transformer â”‚ â”‚   â”‚ â”‚  hum2xml   â”‚ â”‚   â”‚ â”‚  hum2xml   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â”‚   â”‚ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚ â”‚  (convert) â”‚ â”‚   â”‚ â”‚  (convert) â”‚ â”‚
â”‚       â–¼       â”‚   â”‚       â–¼        â”‚   â”‚ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚       â–¼        â”‚   â”‚       â–¼        â”‚
â”‚ â”‚Hand Split â”‚ â”‚   â”‚ â”‚Generate    â”‚ â”‚   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚(pitch     â”‚ â”‚   â”‚ â”‚XML Tokens  â”‚ â”‚   â”‚ â”‚  music21   â”‚ â”‚   â”‚ â”‚  music21   â”‚ â”‚
â”‚ â”‚threshold) â”‚ â”‚   â”‚ â”‚            â”‚ â”‚   â”‚ â”‚ (add clefs,â”‚ â”‚   â”‚ â”‚ (add clefs,â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â”‚   â”‚ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚ â”‚  key, time)â”‚ â”‚   â”‚ â”‚  key, time)â”‚ â”‚
â”‚       â–¼       â”‚   â”‚       â–¼        â”‚   â”‚ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚       â–¼        â”‚   â”‚       â–¼        â”‚
â”‚ â”‚Write XML  â”‚ â”‚   â”‚ â”‚Write XML   â”‚ â”‚   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â”‚   â”‚ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚ â”‚ Write XML  â”‚ â”‚   â”‚ â”‚ Write XML  â”‚ â”‚
â”‚       â”‚       â”‚   â”‚       â”‚        â”‚   â”‚ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                   â”‚                    â”‚                    â”‚
        â–¼                   â–¼                    â–¼                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MusicXML     â”‚   â”‚  MusicXML      â”‚   â”‚  MusicXML      â”‚   â”‚  MusicXML      â”‚
â”‚  (symbolic)   â”‚   â”‚  (symbolic)    â”‚   â”‚  (symbolic)    â”‚   â”‚  (symbolic)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                    â”‚                     â”‚                    â”‚
        â”‚                    â”‚                     â”‚                    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”
â•‘              STAGE 3: Unified XML Processing (All Systems)                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                             â”‚
                             â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚   Validation & Cleanup     â”‚
                â”‚   (music21.converter)      â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â–¼
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚  MusicXML Files  â”‚
                   â”‚  (standardized)  â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â–¼                   â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  Path A:       â”‚   â”‚  Path B:       â”‚
         â”‚  MV2H          â”‚   â”‚  STEPn         â”‚
         â”‚  Evaluation    â”‚   â”‚  Evaluation    â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚                    â”‚
                  â”‚                    â”‚
â”Œâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”
â•‘                    STAGE 4A: MV2H Evaluation Path                             â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                  â”‚
                  â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ XML â†’ MIDI      â”‚
         â”‚ (music21.write) â”‚
         â”‚                 â”‚
         â”‚ Identical for   â”‚
         â”‚ ALL systems     â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Symbolic MIDI   â”‚
         â”‚ (discrete time) â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â–¼                                 â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Predicted MIDI  â”‚              â”‚ Ground Truth    â”‚
         â”‚                 â”‚              â”‚ MIDI (from GT   â”‚
         â”‚                 â”‚              â”‚ MusicXML)       â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚                                â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚  MV2H Evaluation Tool  â”‚
                  â”‚  (music-voice-sep)     â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚     MV2H Metrics       â”‚
                  â”‚                        â”‚
                  â”‚ â€¢ F_p (multi-pitch)    â”‚
                  â”‚ â€¢ F_voi (voice sep)    â”‚
                  â”‚ â€¢ F_val (note value)   â”‚
                  â”‚ â€¢ F_harm (harmony)     â”‚
                  â”‚ â€¢ F_MV2H (average)     â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”
â•‘                    STAGE 4B: STEPn Evaluation Path                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                  â”‚
                  â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Parse XML into  â”‚
         â”‚ Notation Tree   â”‚
         â”‚                 â”‚
         â”‚ Extract:        â”‚
         â”‚ â€¢ Beaming       â”‚
         â”‚ â€¢ Slurs         â”‚
         â”‚ â€¢ Tuplets       â”‚
         â”‚ â€¢ Articulation  â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â–¼                                 â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Predicted Tree  â”‚              â”‚ Ground Truth    â”‚
         â”‚                 â”‚              â”‚ Tree            â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚                                â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚  Tree Edit Distance    â”‚
                  â”‚  (APTED algorithm)     â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚    STEPn Metrics       â”‚
                  â”‚                        â”‚
                  â”‚ â€¢ Beaming accuracy     â”‚
                  â”‚ â€¢ Slur F1-score        â”‚
                  â”‚ â€¢ Tuplet detection     â”‚
                  â”‚ â€¢ Overall TEDn         â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”
â•‘                         STAGE 5: Results Aggregation                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚  Combine All Metrics   â”‚
                  â”‚                        â”‚
                  â”‚  Per-System Summary:   â”‚
                  â”‚  â€¢ MV2H (avg)          â”‚
                  â”‚  â€¢ MV2H (breakdown)    â”‚
                  â”‚  â€¢ STEPn (avg)         â”‚
                  â”‚  â€¢ STEPn (breakdown)   â”‚
                  â”‚                        â”‚
                  â”‚  Statistical Tests:    â”‚
                  â”‚  â€¢ Paired t-test       â”‚
                  â”‚  â€¢ Wilcoxon signed-rankâ”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚    Final Table 1       â”‚
                  â”‚ (Comparison Results)   â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## é—œéµè½‰æ›é»èªªæ˜

### ğŸ”¹ Conversion Point 1: Model Output

| System | Output Format | Characteristics |
|--------|--------------|-----------------|
| MT3 | MIDI (single-track) | Continuous time, no voice separation |
| Transkun | MIDI (single-track) | High-resolution timing, pedal events |
| Zeng | **Kern (dual-voice) | Discrete symbolic, voice-separated |
| Clef | **Kern (dual-voice) | Discrete symbolic, voice-separated |

**Why Different?**
- Pipeline systems model **performance** (physical events)
- E2E systems model **score** (symbolic notation)

---

### ğŸ”¹ Conversion Point 2: Symbolization

| System | Method | Key Operations |
|--------|--------|---------------|
| MT3 + music21 | Rule-based quantization | `quantize(quarterLengthDivisors=[4,3])` + pitch-based hand split |
| Transkun + Beyer | Learned quantization | Transformer predicts note values, beaming, slurs |
| Zeng + Humdrum | Standard tools | `tiefix` (fix notation) + `hum2xml` (convert) + `music21` (add metadata) |
| Clef + Humdrum | Standard tools | Same as Zeng (ensures fair comparison) |

**Why Different?**
- Each system has its **native symbolization process**
- Forcing uniform tools would introduce bias

---

### ğŸ”¹ Conversion Point 3: Unified Evaluation (MusicXML)

**All systems converge here** before metric computation.

```python
# Applied identically to ALL systems
score = music21.converter.parse(xml_path)
score.write('midi', fp=midi_output_path)
```

**Why This is Fair?**
- MusicXML is the **de facto standard** for symbolic music
- music21's XMLâ†’MIDI conversion is **deterministic**
- Same tool, same parameters = no bias

---

## Evaluation Protocol Summary

| Stage | MT3+music21 | Transkun+Beyer | Zeng | Clef |
|-------|-------------|----------------|------|------|
| **Input** | Audio | Audio | Audio | Audio |
| **Model Output** | MIDI | MIDI | **Kern | **Kern |
| **Symbolization** | music21 | Beyer Transformer | Humdrum | Humdrum |
| **Unified Format** | âœ“ XML | âœ“ XML | âœ“ XML | âœ“ XML |
| **XMLâ†’MIDI** | âœ“ music21 | âœ“ music21 | âœ“ music21 | âœ“ music21 |
| **MV2H Eval** | âœ“ Same tool | âœ“ Same tool | âœ“ Same tool | âœ“ Same tool |
| **STEPn Eval** | âœ“ Same tool | âœ“ Same tool | âœ“ Same tool | âœ“ Same tool |

**Fairness Guarantee**: All systems are evaluated using **identical tools** at the XMLâ†’MIDIâ†’Metrics stage.

---

## Comparison with Alternative Designs

### âŒ Design A: Force All Systems to **Kern

```
MT3 â†’ MIDI â†’ [???] â†’ **Kern â†’ XML â†’ MIDI â†’ MV2H
                â†‘
          No standard tool!
```

**Problems:**
- Requires implementing custom MIDIâ†’**Kern converter
- Introduces new error sources
- Unfairly penalizes Pipeline systems

---

### âŒ Design B: Force All Systems Through music21

```
Zeng â†’ **Kern â†’ [music21] â†’ XML â†’ MIDI â†’ MV2H
                    â†‘
            Bypasses Humdrum tools!
```

**Problems:**
- music21 cannot parse **Kern directly
- Nullifies Zeng's design advantages
- Creates unfair "level playing field"

---

### âœ… Design C: Our Approach (Unified at XML)

```
MT3/Transkun â†’ [Native Tools] â†’ XML â”€â”€â”
                                      â”œâ†’ [Same XMLâ†’MIDI] â†’ MV2H
Zeng/Clef â†’ [Native Tools] â†’ XML â”€â”€â”€â”€â”€â”˜
```

**Advantages:**
- Respects each system's design
- No forced conversions
- Fair comparison at symbolic level

---

## Visual Legend

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Box    â”‚  = Processing step or data format
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”‚
    â–¼        = Data flow direction

â”Œâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”
â•‘  Double Box = Major Stage     â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[Tool]   = Software/algorithm used

"Same"   = Identical for all systems (fairness guarantee)
```

---

## File Output Structure

After running full evaluation:

```
outputs/
â”œâ”€â”€ mt3_music21/
â”‚   â”œâ”€â”€ midi/           # Raw MT3 output
â”‚   â”œâ”€â”€ xml/            # After music21 conversion
â”‚   â””â”€â”€ eval_midi/      # For MV2H (from XML)
â”œâ”€â”€ transkun_beyer/
â”‚   â”œâ”€â”€ midi/           # Raw Transkun output
â”‚   â”œâ”€â”€ xml/            # After Beyer conversion
â”‚   â””â”€â”€ eval_midi/      # For MV2H (from XML)
â”œâ”€â”€ zeng/
â”‚   â”œâ”€â”€ kern/           # Zeng model output
â”‚   â”œâ”€â”€ xml/            # After Humdrum conversion
â”‚   â””â”€â”€ eval_midi/      # For MV2H (from XML)
â”œâ”€â”€ clef/
â”‚   â”œâ”€â”€ kern/           # Clef model output
â”‚   â”œâ”€â”€ xml/            # After Humdrum conversion
â”‚   â””â”€â”€ eval_midi/      # For MV2H (from XML)
â””â”€â”€ results/
    â”œâ”€â”€ mv2h_scores.csv
    â”œâ”€â”€ stepn_scores.csv
    â””â”€â”€ comparison_table.csv
```

---

## Reproducibility Checklist

To reproduce our evaluation:

- [ ] Install Humdrum Toolkit (`~/humdrum-tools`)
- [ ] Install Python dependencies (`music21`, `numpy`, `torch`)
- [ ] Download ASAP dataset + MAESTRO audio
- [ ] Download Zeng's test split (`test_asap.txt`)
- [ ] Run MT3 inference (`run_mt3_baseline.py`)
- [ ] Run Transkun+Beyer inference (`run_transkun_beyer.py`)
- [ ] Run Zeng baseline (`run_zeng_baseline.py`)
- [ ] Run Clef inference (`run_clef.py`)
- [ ] Evaluate all systems (`evaluate_all.py`)
- [ ] Generate comparison table (`generate_table.py`)

All scripts will be released with the paper.
